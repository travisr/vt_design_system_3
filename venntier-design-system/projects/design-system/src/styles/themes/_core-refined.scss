@use '@angular/material' as mat;
@use '../tokens' as tokens;

// MODERNIZED: Define the base theme using mat.theme() with system-level overrides
@mixin vt-material-base-theme() {
  // Modern MD3 approach - single theme definition with system-level token overrides
  html {
    @include mat.theme(
      (
        color: (
          theme-type: light,
          use-system-variables: true,
          system-variables-prefix: md-sys-color,
        ),
        typography: (
          use-system-variables: true,
          system-variables-prefix: md-sys-typescale,
        ),
      ),
      $overrides: (
        // System-level token overrides (affects multiple components)
        // These values come from your existing token definitions
        primary: #000000,
        // Black for primary (from tokens)
        on-primary: #ffffff,
        // White text on primary
        tertiary: #10a37f,
        // Green for CTAs (from tokens)
        on-tertiary: #ffffff,
        // White text on tertiary
        outline: #d1d5db,
        // Gray borders (from tokens)
        outline-variant: #e5e5e5,
        // Lighter borders (from tokens)
        surface-container: #f9f9f9,
        // Input backgrounds (from tokens)
        surface-container-lowest: #ffffff,
        // White backgrounds
        surface-container-high: #f0f0f0,
        // Disabled backgrounds
        hover: #ececf1,
        // OpenAI hover color (from tokens)
        selected: #e5e5e5,
        // OpenAI selected color (from tokens)
        focus-ring: #6e6e80,
        // Focus ring color (from tokens)
      )
    );
  }

  @include vt-component-overrides-refined;
}

// MODERNIZED: Apply dark theme using mat.theme() with dark overrides
@mixin vt-material-colors($theme-type: 'light') {
  @if $theme-type == 'dark' {
    // Modern dark theme approach
    @include mat.theme(
      (
        color: (
          theme-type: dark,
          use-system-variables: true,
          system-variables-prefix: md-sys-color,
        ),
      ),
      $overrides: (
        // Dark theme system-level token overrides
        primary: #ffffff,
        // White for dark mode
        on-primary: #000000,
        // Black text on white
        tertiary: #10a37f,
        // Keep green for CTAs
        on-tertiary: #ffffff,
        // White text on green
        surface: #1a1a1a,
        // Dark surface
        on-surface: #ffffff,
        // White text
        surface-container: #2a2a2a,
        // Dark input backgrounds
        surface-container-lowest: #1a1a1a,
        // Darkest backgrounds
        surface-container-high: #3a3a3a,
        // Lighter dark backgrounds
        outline: #4a4a4a,
        // Dark borders
        outline-variant: #3a3a3a,
        // Darker borders
        hover: #2a2a2a,
        // Dark hover
        selected: #3a3a3a,
        // Dark selected
      )
    );

    // Apply additional dark theme color tokens
    @include tokens.apply-dark-colors;
  } @else {
    // Light theme colors are already applied in vt-material-base-theme
    // Apply additional light theme color tokens
    @include tokens.apply-light-colors;
  }
}

@mixin vt-component-overrides-refined() {
  // Global refinements - use CSS custom properties instead of !important
  :root {
    --mdc-elevation-box-shadow-for-gss: none;
    --vt-surface-background: var(--md-sys-color-surface);
    --vt-on-surface-text: var(--md-sys-color-on-surface);
  }

  // Icon button overrides - using official Angular Material API
  @include mat.icon-button-overrides(
    (
      // Container styling - OpenAI 48px square
      state-layer-size: 48px,
      icon-size: 20px,

      // State layer colors - clean OpenAI style
      state-layer-color: var(--md-sys-color-on-surface),
      hover-state-layer-opacity: 0.08,
      focus-state-layer-opacity: 0,
      // Remove focus state layer
      pressed-state-layer-opacity: 0.12,

      // Disable ripples for clean design
      ripple-color: transparent,

      // Disable touch target display which might be causing the outline
      touch-target-display: none,

      // Icon colors - MD3 best practice: use on-surface for primary icon color
      icon-color: var(--md-sys-color-on-surface),
      // Disabled state - use proper disabled color token
      disabled-icon-color: var(--md-sys-color-on-surface-variant),
      disabled-state-layer-color: var(--md-sys-color-on-surface-variant)
    )
  );

  // NOTE: Select panel styling is now handled by mat.select-overrides() below

  // Wrap all component overrides in a single .vt-theme class for higher specificity
  .vt-theme {
    // Body styles with proper CSS custom property usage
    background: var(--vt-surface-background);
    color: var(--vt-on-surface-text);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;

    // Remove shadows using higher specificity
    [class*='mat-elevation-z'],
    [class*='mat-mdc-elevation'],
    .mat-mdc-card,
    .mat-mdc-menu-panel,
    .mat-mdc-dialog-container {
      box-shadow: none;
    }

    // BUTTONS - Use CSS custom properties and higher specificity
    // Regular buttons (not icon buttons)
    .mat-mdc-button,
    .mat-mdc-raised-button,
    .mat-mdc-flat-button,
    .mat-mdc-stroked-button {
      // Heights controlled by density mixins - removed fixed heights for density support
      --mdc-text-button-label-text-font: var(--md-sys-typescale-label-large-font);
      --mdc-text-button-label-text-size: 14px;
      --mdc-text-button-label-text-weight: 400;
      --mdc-text-button-label-text-tracking: 0.01em;

      border-radius: 6px;
      padding: 0 20px;
      transition: all 0.15s ease;
      box-shadow: none;

      // Disable ripples using CSS variables
      --mat-ripple-color: transparent;
      --mdc-ripple-color: transparent;
      --mdc-ripple-hover-opacity: 0;
      --mdc-ripple-focus-opacity: 0;
      --mdc-ripple-pressed-opacity: 0;
    }

    // NOTE: Icon button styling is now handled by mat.icon-button-overrides() above

    // Primary button (green CTA) - Use CSS custom properties
    .mat-mdc-raised-button.mat-primary,
    .mat-mdc-flat-button.mat-primary {
      --mdc-filled-button-container-color: var(--md-sys-color-tertiary);
      --mdc-filled-button-label-text-color: var(--md-sys-color-on-tertiary);
      --mdc-filled-button-hover-container-color: #0d9d6e;
      --mdc-filled-button-label-text-weight: 500;

      &:not(:disabled):hover {
        transform: translateY(-1px);
      }

      &:not(:disabled):active {
        transform: translateY(0);
      }
    }

    // Secondary (outlined) - Use Material's outlined button tokens
    .mat-mdc-stroked-button,
    .mat-mdc-outlined-button {
      --mdc-outlined-button-container-color: transparent;
      --mdc-outlined-button-label-text-color: var(--md-sys-color-on-surface);
      --mdc-outlined-button-outline-color: var(--md-sys-color-outline);
      --mdc-outlined-button-hover-container-color: var(--md-sys-color-hover);
      --mdc-outlined-button-hover-outline-color: var(--md-sys-color-outline-variant);
    }

    // Tertiary (flat) and Text buttons - Use proper CSS custom properties
    .mat-mdc-flat-button:not(.mat-primary) {
      --mdc-filled-button-container-color: var(--md-sys-color-surface-container);
      --mdc-filled-button-label-text-color: var(--md-sys-color-on-surface);
      --mdc-filled-button-hover-container-color: var(--md-sys-color-surface-container-high);

      border: none;
    }

    .mat-mdc-button {
      --mdc-text-button-container-color: transparent;
      --mdc-text-button-label-text-color: var(--md-sys-color-on-surface-variant);
      --mdc-text-button-hover-container-color: var(--md-sys-color-hover);
      --mdc-text-button-hover-label-text-color: var(--md-sys-color-on-surface);

      padding: 0 12px;
    }

    // Disabled state - using CSS custom properties
    button:disabled {
      --mdc-text-button-disabled-label-text-color: var(--md-sys-color-on-surface-variant);
      --mdc-filled-button-disabled-container-color: var(--md-sys-color-surface-variant);
      --mdc-filled-button-disabled-label-text-color: var(--md-sys-color-on-surface-variant);

      opacity: 0.4;
    }

    // CARDS - Use CSS custom properties and higher specificity
    .mat-mdc-card {
      --mdc-elevated-card-container-color: var(--md-sys-color-surface);
      --mdc-elevated-card-container-shape: 8px;

      border: 1px solid var(--md-sys-color-outline-variant);
      border-radius: 8px;
      padding: 24px;
      background-color: var(--md-sys-color-surface);
      margin-bottom: 24px;

      .mat-mdc-card-header {
        padding: 0 0 20px;

        .mat-mdc-card-title {
          font-size: 16px;
          font-weight: 600;
          color: var(--md-sys-color-on-surface);
          margin: 0;
        }
      }

      .mat-mdc-card-content {
        padding: 0;

        > *:not(:last-child) {
          margin-bottom: 16px;
        }
      }
    }

    // FORM FIELDS - No custom CSS, pure MD3 approach only

    // NOTE: Select styling is now handled by mat.select-overrides() above

    // TOOLBAR - Clean style with CSS custom properties
    .mat-toolbar {
      --mat-toolbar-background-color: var(--md-sys-color-surface);
      --mat-toolbar-title-text-color: var(--md-sys-color-on-surface);

      background-color: var(--md-sys-color-surface);
      color: var(--md-sys-color-on-surface);
      border-bottom: 1px solid var(--md-sys-color-outline-variant);
      height: 56px;
      padding: 0 32px;
      font-weight: 400;

      &.mat-primary {
        background-color: var(--md-sys-color-surface);
      }
    }

    // TYPOGRAPHY - Using M3 typescale tokens
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      color: var(--md-sys-color-on-surface);
      margin-top: 0;
    }

    h1 {
      font: var(--md-sys-typescale-headline-large-font);
      font-size: var(--md-sys-typescale-headline-large-size);
      font-weight: var(--md-sys-typescale-headline-large-weight);
      line-height: var(--md-sys-typescale-headline-large-line-height);
      margin-bottom: 12px;
    }

    h2 {
      font: var(--md-sys-typescale-headline-medium-font);
      font-size: var(--md-sys-typescale-headline-medium-size);
      font-weight: var(--md-sys-typescale-headline-medium-weight);
      line-height: var(--md-sys-typescale-headline-medium-line-height);
      margin-bottom: 16px;
    }

    h3 {
      font: var(--md-sys-typescale-headline-small-font);
      font-size: var(--md-sys-typescale-headline-small-size);
      font-weight: var(--md-sys-typescale-headline-small-weight);
      line-height: var(--md-sys-typescale-headline-small-line-height);
      margin-bottom: 12px;
    }

    p {
      color: var(--md-sys-color-on-surface-variant);
      line-height: 1.6;
      margin-bottom: 12px;
    }

    // NOTE: Checkbox styling is now handled by mat.checkbox-overrides() above

    // NOTE: Radio button styling is now handled by mat.radio-overrides() above

    // Chips overrides - using official Angular Material API
    @include mat.chips-overrides(
      (
        // Container styling - OpenAI flat style (outlined only)
        container-shape-radius: 16px,
        // Height controlled by density mixins - removed fixed height for density support
        // Label styling
        label-text-color: var(--md-sys-color-on-surface-variant),
        label-text-font: 'Inter',
        label-text-size: 13px,
        label-text-weight: 400,

        // Outline styling - flat chips with border only
        outline-color: var(--md-sys-color-outline-variant),
        outline-width: 1px,

        // Selected state for flat chips
        flat-selected-outline-width: 1px,
        selected-label-text-color: var(--md-sys-color-on-surface),
        // Icon styling
        with-icon-icon-color: var(--md-sys-color-on-surface-variant),
        with-icon-selected-icon-color: var(--md-sys-color-on-surface),
        // Disabled state
        disabled-label-text-color: var(--md-sys-color-on-surface-variant),
        disabled-container-opacity: 0.38
      )
    );

    // Additional chips customizations not available through overrides
    .mat-mdc-chip {
      // Override MDC chip padding using CSS custom properties
      --mdc-chip-leading-space: 8px; // Reduce left padding
      --mdc-chip-trailing-space: 8px; // Reduce right padding
      --mdc-chip-with-avatar-leading-space: 4px; // Tighter with avatar
      --mdc-chip-with-trailing-icon-trailing-space: 4px; // Tighter with remove icon
    }

    // Hide checkmarks on filter chips for cleaner OpenAI style
    mat-chip-listbox mat-chip-option,
    .mat-mdc-chip-option,
    .mat-mdc-chip {
      // Hide all possible checkmark elements with high specificity
      .mdc-evolution-chip__checkmark,
      .mat-mdc-chip-checkmark,
      .mdc-chip__checkmark,
      .mat-chip-trailing-icon.mat-chip-checkmark,
      .mdc-evolution-chip__checkmark-svg,
      .mdc-evolution-chip__checkmark-path {
        display: none;
        visibility: hidden;
        opacity: 0;
        width: 0;
        height: 0;
        overflow: hidden;
      }

      // Override selected state with OpenAI gray colors
      &.mat-mdc-chip-selected,
      &[aria-selected='true'] {
        background-color: var(--md-sys-color-selected); // #e5e5e5 OpenAI gray
        border-color: var(--md-sys-color-outline); // #d1d5db standard border
        color: var(--md-sys-color-on-surface); // Black text

        // Ensure icons also use the correct color
        mat-icon {
          color: var(--md-sys-color-on-surface);
        }
      }
    }

    // MENU - Same pattern as sidenav but with white background
    .mat-mdc-menu-panel {
      --mat-menu-container-color: var(--md-sys-color-surface);
      --mat-menu-container-shape: var(--md-sys-shape-corner-small);
      --mat-menu-item-label-text-color: var(--md-sys-color-on-surface-variant);
      --mat-menu-item-hover-state-layer-color: transparent;

      border: 1px solid var(--md-sys-color-outline-variant);
      border-radius: var(--md-sys-shape-corner-small);
      background-color: var(--md-sys-color-surface); // White background
      padding: var(--md-sys-spacing-1, 4px) var(--md-sys-spacing-2, 8px); // Add horizontal padding like sidenav
      box-shadow: 0 2px 6px rgb(0 0 0 / 8%);
      min-width: 180px;
      max-width: 280px;
      overflow: hidden;

      .mat-mdc-menu-item {
        // Use same dimensions as sidenav items
        --mdc-list-list-item-container-height: var(--md-sys-spacing-8);
        --mdc-list-list-item-label-text-size: var(--md-sys-typescale-body-medium-size);
        --mdc-list-list-item-label-text-weight: var(--md-sys-typescale-body-medium-weight);
        --mdc-list-list-item-leading-icon-size: var(--md-sys-spacing-4);
        --mdc-list-list-item-trailing-icon-size: var(--md-sys-spacing-4);

        height: var(--md-sys-spacing-8, 32px); // Same as sidenav
        padding: 0 var(--md-sys-spacing-2, 8px); // Same as sidenav
        margin: calc(var(--md-sys-spacing-1) / 2) 0; // Exact same as sidenav - very tight
        border-radius: var(--md-sys-shape-corner-small); // Same as sidenav
        color: var(--md-sys-color-on-surface-variant); // Same as sidenav
        font-size: var(--md-sys-typescale-body-medium-size);
        font-weight: var(--md-sys-typescale-body-medium-weight);
        transition: background-color var(--md-sys-motion-hover);

        // Disable Material's state layer
        &::before {
          opacity: 0;
        }

        // Custom hover state - same as sidenav but more contained
        &:hover:not([disabled]),
        &.mat-mdc-menu-item-highlighted {
          background-color: var(--md-sys-color-hover);
          color: var(--md-sys-color-on-surface-variant);
        }

        // Icon styling - same as sidenav
        mat-icon {
          font-size: 16px;
          width: 16px;
          height: 16px;
          margin-right: 10px;
          color: var(--md-sys-color-on-surface-variant);
          transition: color var(--md-sys-motion-hover);
          display: inline-flex;
          align-items: center;
          justify-content: center;
        }

        // Text content - combined styling with overflow handling
        .mat-mdc-menu-item-text {
          display: flex;
          align-items: center;
          flex: 1;
          color: inherit;
          font-size: var(--md-sys-typescale-body-medium-size);
          line-height: var(--md-sys-typescale-body-medium-line-height);
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        // Trailing icon (chevron, etc.)
        .mat-mdc-menu-item-submenu-trigger-icon {
          font-size: var(--md-sys-spacing-4, 16px);
          width: var(--md-sys-spacing-4, 16px);
          height: var(--md-sys-spacing-4, 16px);
          color: var(--md-sys-color-on-surface-variant);
        }

        // Disabled state
        &[disabled] {
          opacity: 0.38;
          cursor: not-allowed;

          mat-icon {
            opacity: 0.38;
          }
        }

        // Destructive actions (like delete) - keep error styling
        &.mat-warn,
        &[color='warn'] {
          color: var(--md-sys-color-error);

          mat-icon {
            color: var(--md-sys-color-error);
          }

          &:hover {
            background-color: var(--md-sys-color-error-container);
            color: var(--md-sys-color-on-error-container);

            mat-icon {
              color: var(--md-sys-color-on-error-container);
            }
          }
        }
      }

      // Menu dividers
      .mat-mdc-menu-item-divider,
      hr {
        border-top: 1px solid var(--md-sys-color-outline-variant);
        margin: var(--md-sys-spacing-4, 4px) 0;
        border-bottom: none;
        border-left: none;
        border-right: none;
      }
    }

    // PROGRESS - Using tertiary color
    .mat-mdc-progress-bar {
      --mdc-linear-progress-active-indicator-color: var(--md-sys-color-tertiary);
      --mdc-linear-progress-track-color: var(--md-sys-color-surface-container-high);

      height: 4px;
      border-radius: 2px;
    }

    .mat-mdc-progress-spinner {
      --mdc-circular-progress-active-indicator-color: var(--md-sys-color-tertiary);
    }

    // SNACKBAR - Dark container for contrast
    .mat-mdc-snack-bar-container {
      --mdc-snackbar-container-color: var(--md-sys-color-inverse-surface);
      --mdc-snackbar-supporting-text-color: var(--md-sys-color-inverse-on-surface);
      --mdc-snackbar-container-shape: 8px;

      border-radius: 8px;

      .mat-mdc-snack-bar-action {
        color: var(--md-sys-color-tertiary);
      }
    }

    // DIALOG - Clean modal style
    .mat-mdc-dialog-container {
      --mdc-dialog-container-color: var(--md-sys-color-surface);
      --mdc-dialog-container-shape: 12px;

      border: 1px solid var(--md-sys-color-outline-variant);
      border-radius: 12px;
      padding: 32px;
      background-color: var(--md-sys-color-surface);
    }

    // TABLE - Clean data presentation
    table.mat-mdc-table {
      border: 1px solid var(--md-sys-color-outline-variant);
      border-radius: 8px;
      overflow: hidden;
      background-color: var(--md-sys-color-surface);

      .mat-mdc-header-row {
        background-color: var(--md-sys-color-surface-variant);

        // Height controlled by Angular Material density system - removed fixed height
        border-bottom: 1px solid var(--md-sys-color-outline-variant);
      }

      .mat-mdc-row {
        // Height controlled by Angular Material density system - removed fixed height
        border-bottom: 1px solid var(--md-sys-color-outline-variant);

        &:hover {
          background-color: var(--md-sys-color-hover);
        }

        &:last-child {
          border-bottom: none;
        }
      }

      .mat-mdc-cell,
      .mat-mdc-header-cell {
        font-size: 14px;
        padding: 0 16px;
      }

      .mat-mdc-header-cell {
        font-weight: 500;
        color: var(--md-sys-color-on-surface-variant);
      }

      .mat-mdc-cell {
        color: var(--md-sys-color-on-surface);
      }
    }

    // NOTE: Slide toggle styling is now handled by mat.slide-toggle-overrides() above

    // TOOLTIP - Inverse colors for contrast
    .mat-mdc-tooltip {
      --mdc-plain-tooltip-container-color: var(--md-sys-color-inverse-surface);
      --mdc-plain-tooltip-supporting-text-color: var(--md-sys-color-inverse-on-surface);
      --mdc-plain-tooltip-container-shape: 6px;

      background-color: var(--md-sys-color-inverse-surface);
      color: var(--md-sys-color-inverse-on-surface);
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 6px;
    }

    // ICON refinements - size only, let component overrides handle colors per MD3
    .mat-icon,
    mat-icon {
      font-size: 20px;
      width: 20px;
      height: 20px;

      // Removed global color override - let component-specific overrides handle colors per MD3

      &.mat-icon-button mat-icon {
        font-size: 20px;
      }
    }

    // NOTE: Focus states are now handled by component-specific overrides
    // Removed global focus-visible to let overrides manage focus styling

    // Selection
    ::selection {
      background-color: var(--md-sys-color-tertiary-container);
      color: var(--md-sys-color-on-tertiary-container);
    }
  }

  // MODERNIZED: Add official Angular Material component override mixins
  // These replace the extensive custom CSS in component files
  @include vt-modern-component-overrides;
}

// Modern component overrides using official Angular Material APIs
@mixin vt-modern-component-overrides() {
  // Button overrides - replaces most of _button.scss
  @include mat.button-overrides(
    (
      // Heights controlled by density mixins - removed fixed heights for density support
      // Filled button (primary CTA) - Green
      filled-container-color: var(--md-sys-color-tertiary),
      filled-label-text-color: var(--md-sys-color-on-tertiary),
      filled-state-layer-color: var(--md-sys-color-on-tertiary),
      filled-hover-state-layer-opacity: 0.08,
      filled-pressed-state-layer-opacity: 0.12,

      // Outlined button (secondary) - Black outline
      outlined-outline-color: var(--md-sys-color-outline),
      outlined-label-text-color: var(--md-sys-color-on-surface),
      outlined-state-layer-color: var(--md-sys-color-on-surface),
      outlined-hover-state-layer-opacity: 0.08,
      outlined-pressed-state-layer-opacity: 0.12,
      outlined-outline-width: 1px,

      // Text button (tertiary)
      text-label-text-color: var(--md-sys-color-on-surface-variant),
      text-state-layer-color: var(--md-sys-color-on-surface-variant),
      text-hover-state-layer-opacity: 0.08,
      text-pressed-state-layer-opacity: 0.12,

      // Shared properties
      filled-container-shape: 6px,
      outlined-container-shape: 6px,
      text-container-shape: 6px,
      filled-label-text-weight: 450,
      outlined-label-text-weight: 450,
      text-label-text-weight: 450,
      filled-label-text-font: 'Inter',
      outlined-label-text-font: 'Inter',
      text-label-text-font: 'Inter'
    )
  );

  // Button Toggle overrides using official Angular Material API
  @include mat.button-toggle-overrides(
    (
      // Selected state styling - OpenAI clean design
      selected-state-background-color: var(--md-sys-color-selected),
      selected-state-text-color: var(--md-sys-color-on-surface),
      // Unselected state styling (using correct token names from error message)
      background-color: var(--md-sys-color-surface),
      text-color: var(--md-sys-color-on-surface),
      // Border and divider styling
      divider-color: var(--md-sys-color-outline-variant),
      // Shape
      shape: var(--md-sys-shape-corner-medium),
      // Typography
      label-text-font: 'Inter',
      label-text-size: var(--md-sys-typescale-body-large-size),
      label-text-weight: 400
    )
  );

  // Global density configuration using official Angular Material API
  // MD3 density scale: 0 is default/comfortable, negative values are more compact
  @include mat.all-component-densities(0);

  // MD3 density classes - only negative values and 0 are supported
  .dense {
    @include mat.all-component-densities(-3);
  }

  .compact {
    @include mat.all-component-densities(-2);
  }

  .standard {
    @include mat.all-component-densities(-1);
  }

  // Note: Positive density values (+1, +2) are not supported in MD3
  // 0 is the maximum (most comfortable) density

  // Density selector consistent width across all demo pages
  .density-selector {
    mat-form-field {
      width: 450px; // Fixed width to show full option text on single line
    }
  }

  // FAB (Floating Action Button) overrides using official Angular Material API
  @include mat.fab-overrides(
    (
      // Container styling - OpenAI flat design
      container-color: var(--md-sys-color-tertiary),
      container-shape: 16px,
      container-elevation-shadow: none,

      // Flat design
      // Icon styling
      foreground-color: var(--md-sys-color-on-tertiary),
      // State layer styling
      state-layer-color: var(--md-sys-color-on-tertiary),
      hover-state-layer-opacity: 0.08,
      focus-state-layer-opacity: 0.12,
      pressed-state-layer-opacity: 0.12,

      // Disabled state
      disabled-state-container-color: var(--md-sys-color-surface-variant),
      disabled-state-foreground-color: var(--md-sys-color-on-surface-variant),
      // Ripple disabled
      ripple-color: transparent
    )
  );

  // Additional FAB customizations not available through overrides
  .mat-mdc-fab,
  .mat-mdc-mini-fab {
    // Force flat design - override any elevation shadows with higher specificity
    box-shadow: none;

    // Ensure no elevation on all states
    &:hover,
    &:focus,
    &:active {
      box-shadow: none;
    }

    // Ensure proper icon contrast - white icons on green background
    // Using higher specificity instead of !important
    &.mat-mdc-fab mat-icon,
    &.mat-mdc-mini-fab mat-icon {
      color: var(--md-sys-color-on-tertiary);
    }
  }

  // Card overrides - replaces most of _card.scss
  @include mat.card-overrides(
    (
      // OpenAI flat design - no elevation
      elevated-container-elevation: 0,
      outlined-container-elevation: 0,

      // Container styling
      elevated-container-color: var(--md-sys-color-surface),
      outlined-container-color: var(--md-sys-color-surface),
      elevated-container-shape: 8px,
      outlined-container-shape: 8px,
      outlined-outline-width: 1px,
      outlined-outline-color: var(--md-sys-color-outline-variant),
      // Typography tokens for card content
      title-text-font: 'Inter',
      title-text-size: var(--md-sys-typescale-headline-small-size),
      title-text-weight: var(--md-sys-typescale-headline-small-weight),
      title-text-line-height: var(--md-sys-typescale-headline-small-line-height),
      subtitle-text-color: var(--md-sys-color-on-surface-variant),
      subtitle-text-font: 'Inter',
      subtitle-text-size: var(--md-sys-typescale-body-medium-size),
      subtitle-text-weight: var(--md-sys-typescale-body-medium-weight)
    )
  );

  // Form field overrides - using Angular Material 19 override system
  @include mat.form-field-overrides(
    (
      // Outlined text field styling
      outlined-container-shape: 8px,
      outlined-outline-width: 1px,
      outlined-focus-outline-width: 2px
    )
  );

  // Clean input styling to remove browser defaults (not available as override tokens)
  .mat-mdc-form-field .mdc-text-field__input {
    border: none;
    outline: none;
    box-shadow: none;
    background: transparent;
  }

  // Select overrides - replaces select styling in _input.scss and _form-fields.scss
  @include mat.select-overrides(
    (
      // Panel (dropdown) styling
      panel-background-color: var(--md-sys-color-surface),
      // Trigger (select field) styling
      enabled-trigger-text-color: var(--md-sys-color-on-surface),
      disabled-trigger-text-color: var(--md-sys-color-disabled),
      placeholder-text-color: var(--md-sys-color-on-surface-variant),
      // Arrow styling
      enabled-arrow-color: var(--md-sys-color-on-surface-variant),
      disabled-arrow-color: var(--md-sys-color-disabled),
      focused-arrow-color: var(--md-sys-color-primary),
      invalid-arrow-color: var(--md-sys-color-error),
      // Typography
      trigger-text-font: 'Inter',
      trigger-text-size: var(--md-sys-typescale-body-large-size),
      trigger-text-weight: var(--md-sys-typescale-body-large-weight)
    )
  );
}

// Checkbox overrides - replaces checkbox styling in _input.scss
@include mat.checkbox-overrides(
  (
    // Selected state - using tertiary color for OpenAI style
    selected-icon-color: var(--md-sys-color-tertiary),
    selected-checkmark-color: var(--md-sys-color-on-tertiary),
    // Unselected state
    unselected-icon-color: var(--md-sys-color-outline),
    unselected-hover-icon-color: var(--md-sys-color-outline),
    // Label styling
    label-text-color: var(--md-sys-color-on-surface),
    label-text-font: 'Inter',
    label-text-size: var(--md-sys-typescale-body-large-size),
    label-text-weight: var(--md-sys-typescale-body-large-weight),
    // Disabled state
    disabled-label-color: var(--md-sys-color-disabled),
    disabled-selected-icon-color: var(--md-sys-color-disabled),
    disabled-unselected-icon-color: var(--md-sys-color-disabled)
  )
);

// Radio button overrides - replaces radio styling in _input.scss
@include mat.radio-overrides(
  (
    // Selected state - using tertiary color for OpenAI style
    selected-icon-color: var(--md-sys-color-tertiary),
    // Unselected state
    unselected-icon-color: var(--md-sys-color-outline),
    unselected-hover-icon-color: var(--md-sys-color-outline),
    // Label styling
    label-text-color: var(--md-sys-color-on-surface),
    label-text-font: 'Inter',
    label-text-size: var(--md-sys-typescale-body-large-size),
    label-text-weight: var(--md-sys-typescale-body-large-weight),
    // Disabled state
    disabled-label-color: var(--md-sys-color-disabled),
    disabled-selected-icon-color: var(--md-sys-color-disabled),
    disabled-unselected-icon-color: var(--md-sys-color-disabled),
    // Ripple effects
    checked-ripple-color: var(--md-sys-color-tertiary),
    ripple-color: var(--md-sys-color-outline)
  )
);

// List overrides - replaces most of _list-overrides.scss
@include mat.list-overrides(
  (
    // Container styling
    list-item-container-color: transparent,
    list-item-container-shape: var(--md-sys-shape-corner-small),
    // More compact heights to match sidenav style (sidenav uses 32px)
    list-item-one-line-container-height: 32px,
    // Matches sidenav height exactly
    list-item-two-line-container-height: 48px,
    // Compact for two-line content
    list-item-three-line-container-height: 64px,
    // Compact for three-line content
    // More compact icon spacing to match sidenav style
    list-item-leading-icon-start-space: 4px,
    // Reduced from 16px to match sidenav
    list-item-leading-icon-end-space: 4px,
    // Reduced from 16px to match sidenav
    // Label text styling
    list-item-label-text-color: var(--md-sys-color-on-surface-variant),
    list-item-label-text-font: 'Inter',
    list-item-label-text-size: 14px,
    list-item-label-text-weight: 400,

    // Icon styling
    list-item-leading-icon-color: var(--md-sys-color-on-surface-variant),
    list-item-trailing-icon-color: var(--md-sys-color-on-surface-variant),
    list-item-leading-icon-size: 16px,
    list-item-trailing-icon-size: 16px,

    // Hover state
    list-item-hover-state-layer-color: var(--md-sys-color-hover),
    list-item-hover-label-text-color: var(--md-sys-color-on-surface-variant),
    list-item-hover-leading-icon-color: var(--md-sys-color-on-surface-variant),
    // Selected/Active state
    list-item-selected-container-color: var(--md-sys-color-selected),
    list-item-selected-trailing-icon-color: var(--md-sys-color-primary),
    // Focus state
    list-item-focus-state-layer-color: transparent,

    // Disabled state
    list-item-disabled-label-text-color: var(--md-sys-color-disabled),
    list-item-disabled-leading-icon-color: var(--md-sys-color-disabled)
  )
);

// Slide toggle overrides - replaces slide toggle styling in _input.scss
@include mat.slide-toggle-overrides(
  (
    // Selected state - using tertiary color for OpenAI style
    selected-track-color: var(--md-sys-color-tertiary),
    selected-handle-color: var(--md-sys-color-on-tertiary),
    selected-hover-track-color: var(--md-sys-color-tertiary),
    // Unselected state
    unselected-track-color: var(--md-sys-color-outline-variant),
    unselected-handle-color: var(--md-sys-color-surface),
    unselected-hover-track-color: var(--md-sys-color-outline),
    // Label styling
    label-text-color: var(--md-sys-color-on-surface),
    label-text-font: 'Inter',
    label-text-size: var(--md-sys-typescale-body-large-size),
    label-text-weight: var(--md-sys-typescale-body-large-weight),
    // Disabled state
    disabled-selected-track-color: var(--md-sys-color-disabled),
    disabled-unselected-track-color: var(--md-sys-color-disabled),
    disabled-selected-handle-color: var(--md-sys-color-disabled),
    disabled-unselected-handle-color: var(--md-sys-color-disabled)
  )
);

// Toolbar overrides - replaces most of _toolbar.scss
@include mat.toolbar-overrides(
  (
    // Container styling - OpenAI clean design
    container-background-color: var(--md-sys-color-surface),
    container-text-color: var(--md-sys-color-on-surface),
    standard-height: 64px,
    mobile-height: 64px
  )
);

// Custom card CSS for properties not available as tokens
.mat-mdc-card {
  // OpenAI styling - 32px padding, borders, hover states
  padding: 32px;
  border: 1px solid var(--md-sys-color-outline-variant);
  box-shadow: none; // Ensure flat design
  transition: all var(--md-sys-motion-hover);

  &:hover {
    border-color: var(--md-sys-color-outline);
  }

  // Card sections with proper spacing
  .mat-mdc-card-header {
    padding: 0;
    margin-bottom: 24px;

    .mat-mdc-card-header-text {
      margin: 0;
    }

    .mat-mdc-card-title {
      margin-bottom: 8px;
    }

    .mat-mdc-card-subtitle {
      margin: 0;
    }

    .mat-mdc-card-avatar {
      width: 40px;
      height: 40px;
      border-radius: var(--md-sys-shape-corner-full);
      margin-right: 16px;
    }
  }

  .mat-mdc-card-content {
    padding: 0;
    font-size: var(--md-sys-typescale-body-large-size);
    line-height: var(--md-sys-typescale-body-large-line-height);
    color: var(--md-sys-color-on-surface);

    > *:not(:last-child) {
      margin-bottom: 16px;
    }

    p {
      margin: 0 0 16px;

      &:last-child {
        margin-bottom: 0;
      }
    }
  }

  .mat-mdc-card-actions {
    padding: 0;
    margin-top: 24px;
    display: flex;
    gap: 8px;
    align-items: center;

    &.mat-mdc-card-actions-align-end {
      justify-content: flex-end;
    }

    .mat-mdc-button,
    .mat-mdc-raised-button,
    .mat-mdc-outlined-button {
      margin: 0;
    }
  }

  .mat-mdc-card-footer {
    padding: 0;
    margin-top: 24px;
    padding-top: 24px;
    border-top: 1px solid var(--md-sys-color-outline-variant);
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--md-sys-color-on-surface-variant);
  }

  // Card image handling
  .mat-mdc-card-image {
    margin: -32px -32px 32px;
    border-radius: var(--md-sys-shape-corner-medium) var(--md-sys-shape-corner-medium) 0 0;
    width: calc(100% + 64px);
    display: block;
  }

  .mat-mdc-card-sm-image {
    width: 80px;
    height: 80px;
    border-radius: var(--md-sys-shape-corner-small);
  }

  .mat-mdc-card-lg-image {
    width: 100%;
    height: 200px;
    object-fit: cover;
    border-radius: var(--md-sys-shape-corner-small);
    margin-bottom: 16px;
  }
}

// Card variants and utility classes
.mat-mdc-card.vt-card--compact {
  padding: 24px;
}

.mat-mdc-card.vt-card--comfortable {
  padding: 40px;
}

.mat-mdc-card.vt-card--borderless {
  border: none;
  background-color: transparent;
  padding: 0;
}

.mat-mdc-card.vt-card--interactive {
  cursor: pointer;

  &:hover {
    background-color: var(--md-sys-color-hover);
    border-color: var(--md-sys-color-outline);
  }

  &:active {
    background-color: var(--md-sys-color-selected);
  }
}

.mat-mdc-card.vt-card--selected {
  background-color: var(--md-sys-color-selected);
  border-color: var(--md-sys-color-primary);
}

// Layout helpers
.vt-card-section {
  margin-bottom: 32px;

  &:last-child {
    margin-bottom: 0;
  }
}

.vt-card-grid {
  display: grid;
  gap: 24px;

  &.vt-card-grid--2 {
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  }

  &.vt-card-grid--3 {
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  }

  &.vt-card-grid--4 {
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  }
}

.vt-card-list {
  display: flex;
  flex-direction: column;
  gap: 16px;
}
